<!DOCTYPE html>
<html>
<head>
<title>13.数据库设计.md</title>
<meta http-equiv="Content-type" content="text/html;charset=UTF-8">

<style>
/* https://github.com/microsoft/vscode/blob/master/extensions/markdown-language-features/media/markdown.css */
/*---------------------------------------------------------------------------------------------
 *  Copyright (c) Microsoft Corporation. All rights reserved.
 *  Licensed under the MIT License. See License.txt in the project root for license information.
 *--------------------------------------------------------------------------------------------*/

body {
	font-family: var(--vscode-markdown-font-family, -apple-system, BlinkMacSystemFont, "Segoe WPC", "Segoe UI", "Ubuntu", "Droid Sans", sans-serif);
	font-size: var(--vscode-markdown-font-size, 14px);
	padding: 0 26px;
	line-height: var(--vscode-markdown-line-height, 22px);
	word-wrap: break-word;
}

#code-csp-warning {
	position: fixed;
	top: 0;
	right: 0;
	color: white;
	margin: 16px;
	text-align: center;
	font-size: 12px;
	font-family: sans-serif;
	background-color:#444444;
	cursor: pointer;
	padding: 6px;
	box-shadow: 1px 1px 1px rgba(0,0,0,.25);
}

#code-csp-warning:hover {
	text-decoration: none;
	background-color:#007acc;
	box-shadow: 2px 2px 2px rgba(0,0,0,.25);
}

body.scrollBeyondLastLine {
	margin-bottom: calc(100vh - 22px);
}

body.showEditorSelection .code-line {
	position: relative;
}

body.showEditorSelection .code-active-line:before,
body.showEditorSelection .code-line:hover:before {
	content: "";
	display: block;
	position: absolute;
	top: 0;
	left: -12px;
	height: 100%;
}

body.showEditorSelection li.code-active-line:before,
body.showEditorSelection li.code-line:hover:before {
	left: -30px;
}

.vscode-light.showEditorSelection .code-active-line:before {
	border-left: 3px solid rgba(0, 0, 0, 0.15);
}

.vscode-light.showEditorSelection .code-line:hover:before {
	border-left: 3px solid rgba(0, 0, 0, 0.40);
}

.vscode-light.showEditorSelection .code-line .code-line:hover:before {
	border-left: none;
}

.vscode-dark.showEditorSelection .code-active-line:before {
	border-left: 3px solid rgba(255, 255, 255, 0.4);
}

.vscode-dark.showEditorSelection .code-line:hover:before {
	border-left: 3px solid rgba(255, 255, 255, 0.60);
}

.vscode-dark.showEditorSelection .code-line .code-line:hover:before {
	border-left: none;
}

.vscode-high-contrast.showEditorSelection .code-active-line:before {
	border-left: 3px solid rgba(255, 160, 0, 0.7);
}

.vscode-high-contrast.showEditorSelection .code-line:hover:before {
	border-left: 3px solid rgba(255, 160, 0, 1);
}

.vscode-high-contrast.showEditorSelection .code-line .code-line:hover:before {
	border-left: none;
}

img {
	max-width: 100%;
	max-height: 100%;
}

a {
	text-decoration: none;
}

a:hover {
	text-decoration: underline;
}

a:focus,
input:focus,
select:focus,
textarea:focus {
	outline: 1px solid -webkit-focus-ring-color;
	outline-offset: -1px;
}

hr {
	border: 0;
	height: 2px;
	border-bottom: 2px solid;
}

h1 {
	padding-bottom: 0.3em;
	line-height: 1.2;
	border-bottom-width: 1px;
	border-bottom-style: solid;
}

h1, h2, h3 {
	font-weight: normal;
}

table {
	border-collapse: collapse;
}

table > thead > tr > th {
	text-align: left;
	border-bottom: 1px solid;
}

table > thead > tr > th,
table > thead > tr > td,
table > tbody > tr > th,
table > tbody > tr > td {
	padding: 5px 10px;
}

table > tbody > tr + tr > td {
	border-top: 1px solid;
}

blockquote {
	margin: 0 7px 0 5px;
	padding: 0 16px 0 10px;
	border-left-width: 5px;
	border-left-style: solid;
}

code {
	font-family: Menlo, Monaco, Consolas, "Droid Sans Mono", "Courier New", monospace, "Droid Sans Fallback";
	font-size: 1em;
	line-height: 1.357em;
}

body.wordWrap pre {
	white-space: pre-wrap;
}

pre:not(.hljs),
pre.hljs code > div {
	padding: 16px;
	border-radius: 3px;
	overflow: auto;
}

pre code {
	color: var(--vscode-editor-foreground);
	tab-size: 4;
}

/** Theming */

.vscode-light pre {
	background-color: rgba(220, 220, 220, 0.4);
}

.vscode-dark pre {
	background-color: rgba(10, 10, 10, 0.4);
}

.vscode-high-contrast pre {
	background-color: rgb(0, 0, 0);
}

.vscode-high-contrast h1 {
	border-color: rgb(0, 0, 0);
}

.vscode-light table > thead > tr > th {
	border-color: rgba(0, 0, 0, 0.69);
}

.vscode-dark table > thead > tr > th {
	border-color: rgba(255, 255, 255, 0.69);
}

.vscode-light h1,
.vscode-light hr,
.vscode-light table > tbody > tr + tr > td {
	border-color: rgba(0, 0, 0, 0.18);
}

.vscode-dark h1,
.vscode-dark hr,
.vscode-dark table > tbody > tr + tr > td {
	border-color: rgba(255, 255, 255, 0.18);
}

</style>

<style>
/* Tomorrow Theme */
/* http://jmblog.github.com/color-themes-for-google-code-highlightjs */
/* Original theme - https://github.com/chriskempson/tomorrow-theme */

/* Tomorrow Comment */
.hljs-comment,
.hljs-quote {
	color: #8e908c;
}

/* Tomorrow Red */
.hljs-variable,
.hljs-template-variable,
.hljs-tag,
.hljs-name,
.hljs-selector-id,
.hljs-selector-class,
.hljs-regexp,
.hljs-deletion {
	color: #c82829;
}

/* Tomorrow Orange */
.hljs-number,
.hljs-built_in,
.hljs-builtin-name,
.hljs-literal,
.hljs-type,
.hljs-params,
.hljs-meta,
.hljs-link {
	color: #f5871f;
}

/* Tomorrow Yellow */
.hljs-attribute {
	color: #eab700;
}

/* Tomorrow Green */
.hljs-string,
.hljs-symbol,
.hljs-bullet,
.hljs-addition {
	color: #718c00;
}

/* Tomorrow Blue */
.hljs-title,
.hljs-section {
	color: #4271ae;
}

/* Tomorrow Purple */
.hljs-keyword,
.hljs-selector-tag {
	color: #8959a8;
}

.hljs {
	display: block;
	overflow-x: auto;
	color: #4d4d4c;
	padding: 0.5em;
}

.hljs-emphasis {
	font-style: italic;
}

.hljs-strong {
	font-weight: bold;
}
</style>

<style>
/*
 * Markdown PDF CSS
 */

 body {
	font-family: -apple-system, BlinkMacSystemFont, "Segoe WPC", "Segoe UI", "Ubuntu", "Droid Sans", sans-serif, "Meiryo";
	padding: 0 12px;
}

pre {
	background-color: #f8f8f8;
	border: 1px solid #cccccc;
	border-radius: 3px;
	overflow-x: auto;
	white-space: pre-wrap;
	overflow-wrap: break-word;
}

pre:not(.hljs) {
	padding: 23px;
	line-height: 19px;
}

blockquote {
	background: rgba(127, 127, 127, 0.1);
	border-color: rgba(0, 122, 204, 0.5);
}

.emoji {
	height: 1.4em;
}

code {
	font-size: 14px;
	line-height: 19px;
}

/* for inline code */
:not(pre):not(.hljs) > code {
	color: #ff0000; /* Change the old color so it seems less like an error */
	font-size: inherit;
}

/* Page Break : use <div class="page"/> to insert page break
-------------------------------------------------------- */
.page {
	page-break-after: always;
}

</style>

<script src="https://unpkg.com/mermaid/dist/mermaid.min.js"></script>
</head>
<body>
  <script>
    mermaid.initialize({
      startOnLoad: true,
      theme: document.body.classList.contains('vscode-dark') || document.body.classList.contains('vscode-high-contrast')
          ? 'dark'
          : 'default'
    });
  </script>
<h1 id="%E6%95%B0%E6%8D%AE%E5%BA%93%E8%AE%BE%E8%AE%A1">数据库设计</h1>
<h2 id="%E6%95%B0%E6%8D%AE%E5%BA%93%E8%AE%BE%E8%AE%A1%E8%BF%87%E7%A8%8B">数据库设计过程</h2>
<img src="./p112.png" width="300">
<h2 id="er%E6%A8%A1%E5%9E%8B">ER模型</h2>
<ul>
<li>
<h3 id="%E5%AE%9E%E4%BD%93%E9%97%B4%E8%81%94%E7%B3%BB%E7%B1%BB%E5%9E%8B">实体间联系类型</h3>
<img src="./p113.png" width="300">
<p>上图分别是1:1联系，1:n联系和m:n联系</p>
</li>
<li>
<h3 id="er%E5%9B%BE%E5%90%91%E5%85%B3%E7%B3%BB%E6%A8%A1%E5%9E%8B%E7%9A%84%E8%BD%AC%E6%8D%A2">ER图向关系模型的转换</h3>
<p>转换的基本原则是：实体和联系分别转换成关系，属性则转换成相应关系的属性</p>
<ul>
<li>
<p>一对一联系<br>
<mark><strong>可以合并到任何一边</strong></mark><br>
<img src="./p114.png" width="300"></p>
</li>
<li>
<p>一对多联系<br>
<mark><strong>只能合并到多的一边</strong></mark><br>
<img src="./p115.png" width="300"></p>
</li>
<li>
<p>多对多联系<br>
<mark><strong>不能合并到任何一边</strong></mark></p>
</li>
</ul>
</li>
</ul>
<h2 id="%E6%A1%88%E4%BE%8B%E5%88%86%E6%9E%90">案例分析</h2>
<p>例1：<br>
    某公司拟开发一个宾馆客房预订子系统，主要是针对客房的预订和入住等情况进行管理。<br>
【需求分析结果】<br>
    (1)员工信息主要包括：员工号、姓名、出生年月、性别、部门、岗位、住址、联系电话和密码等信息。岗位有管理和服务两种。岗位为“管理”的员工可以更改（添加、删除和修改）员工表中的本部门员工的岗位和密码，要求将每一次更改前的信息保留；岗位为“服务”的员工只能修改员工表中本人的密码，且负责多个客房的清理等工作。<br>
    (2)部门信息主要包括：部门号、部门名称、部门负责人、电话等信息；一个员工只能属于一个部门，一个部门只有一位负责人。<br>
    (3)客房信息包括：客房号、类型、价格、状态等信息。其中类型是指单人间、三人间、普通标准间、豪华标准间等：状态是指空闲、入住和维修。<br>
    (4)客户信息包括：身份证号、姓名、性别、单位和联系电话。<br>
    (5)房预定情况包括：客房号、预定日期、预定入住日期、预定入住天数、身份证号等信息。一条预定信息必须仅对应一位客户，但一位客户可以有多条预定信息。<br>
【概念模型设计】<br>
<img src="./p116.png" width="500"></p>
<p>【逻辑结构设计】<br>
逻辑结构设计阶段设计的部分关系模式（不完整）如下：<br>
员工（(4)，姓名，出生年月，性别，岗位，住址，联系电话，密码）<br>
权限（岗位，操作权限）
部门（部门号，部门名称，部门负责人，电话）
客房（(5)，类型，价格，状态，入住日期，入住时间，员工号）<br>
客户（(6)，姓名，性别，单位，联系电话）<br>
更改权限（员工号，(7)，密码，更改日期，更改时间，管理员号）<br>
预订情况（(8)，预订日期，预定入住日期，预定入住天数<br>
【问题1】<br>
    根据问题描述，天蝎途中(1)-(3)中的联系类型，使用1:1、1:n、1:*、m:n、*:*表示<br>
【问题2】<br>
    补充途中联系并指明联系类型<br>
【问题3】<br>
    根绝需求分析结果和上图，将逻辑结构设计阶段生成的关系模式中的空(4)~(8)补充完整，注意一个空可能需要填多个属性<br>
【问题4】<br>
    若去掉权限表，并且将权限表中的操作权限属性放在员工表中（仍保持管理和服务岗位的操作规定），则与原有的设计相比有什么优缺点（从数据库设计的角度进行说明）<br>
<strong><code>下面为解答</code></strong></p>
<hr>
<p>解：<br>
【问题1】<br>
(1)：n:1<br>
(2)：m:*<br>
(3)：*:n<br>
【问题2】<br>
员工和权限1:n<br>
【问题3】<br>
(4)：员工号、部门号<br>
(5)：客房号<br>
(6)：身份证号<br>
(7)：岗位<br>
(8)：客房号、身份证号<br>
【问题4】<br>
如果去掉：<br>
缺点：造成数据冗余
优点：减少连接，加速查询</p>
<p><strong><code>下面为另外一题</code></strong></p>
<hr>
<p>例2：<br>
【说明】<br>
    某集团公司将有多个大型连锁商场，公司需要构建一个数据库系统以方便管理其业务运作活动。<br>
【需求分析结果】<br>
    (1)商场需要记录的信息包括商场的编号（编号唯一），商场名称，地址和联系电话。商场信息如表所示</p>
<table>
<thead>
<tr>
<th style="text-align:center">商场编号</th>
<th style="text-align:center">商场名称</th>
<th style="text-align:center">地址</th>
<th style="text-align:center">联系电话</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">PS2101</td>
<td style="text-align:center">淮海商场</td>
<td style="text-align:center">淮海中路918号</td>
<td style="text-align:center">021-64158818</td>
</tr>
<tr>
<td style="text-align:center">PS2902</td>
<td style="text-align:center">西大街商场</td>
<td style="text-align:center">次大姐时代盛典大厦</td>
<td style="text-align:center">029-87283220</td>
</tr>
<tr>
<td style="text-align:center">PS2903</td>
<td style="text-align:center">东大街商场</td>
<td style="text-align:center">碑林区东大街239号</td>
<td style="text-align:center">029-87450287</td>
</tr>
<tr>
<td style="text-align:center">PS2901</td>
<td style="text-align:center">长安商场</td>
<td style="text-align:center">雁塔区长安中路38号</td>
<td style="text-align:center">029-85264953</td>
</tr>
</tbody>
</table>
<p>    (2)每个商场包含有不同的部门，部门需要记录的信息包括部门编号（集团公司分配），部门名称，位置分布和联系电话，某商场部门信息如下表所示</p>
<table>
<thead>
<tr>
<th style="text-align:center">部门编号</th>
<th style="text-align:center">部门名称</th>
<th style="text-align:center">位置分布</th>
<th style="text-align:center">联系电话</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">DT002</td>
<td style="text-align:center">账务部</td>
<td style="text-align:center">商场大楼六层</td>
<td style="text-align:center">82504342</td>
</tr>
<tr>
<td style="text-align:center">DT007</td>
<td style="text-align:center">后勤部</td>
<td style="text-align:center">商场地下负一层</td>
<td style="text-align:center">82504347</td>
</tr>
<tr>
<td style="text-align:center">DT021</td>
<td style="text-align:center">安保部</td>
<td style="text-align:center">商场地下负一层</td>
<td style="text-align:center">82404358</td>
</tr>
<tr>
<td style="text-align:center">DT005</td>
<td style="text-align:center">人事部</td>
<td style="text-align:center">商场大楼六层</td>
<td style="text-align:center">82504446</td>
</tr>
<tr>
<td style="text-align:center">DT001</td>
<td style="text-align:center">管理部</td>
<td style="text-align:center">商场裙楼三层</td>
<td style="text-align:center">82504668</td>
</tr>
</tbody>
</table>
<p>    (3)每个部门雇佣多名员工处理日常事务，每名员工只能隶属于一个部门（新进员工在培训班不隶属于任何部门）。员工需要记录的信息包括员工编号（集团公司分配），姓名，岗位，电话号码和工资。员工信息如下表所示</p>
<table>
<thead>
<tr>
<th style="text-align:center">员工编号</th>
<th style="text-align:center">姓名</th>
<th style="text-align:center">岗位</th>
<th style="text-align:center">电话号码</th>
<th style="text-align:center">工资</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">XA3310</td>
<td style="text-align:center">周超</td>
<td style="text-align:center">理货员</td>
<td style="text-align:center">13609257638</td>
<td style="text-align:center">1500.00</td>
</tr>
<tr>
<td style="text-align:center">SH1075</td>
<td style="text-align:center">刘飞</td>
<td style="text-align:center">防损员</td>
<td style="text-align:center">13477293487</td>
<td style="text-align:center">1500.00</td>
</tr>
<tr>
<td style="text-align:center">XA0048</td>
<td style="text-align:center">江雪花</td>
<td style="text-align:center">广播员</td>
<td style="text-align:center">15234567893</td>
<td style="text-align:center">1428.00</td>
</tr>
<tr>
<td style="text-align:center">BJ3123</td>
<td style="text-align:center">张正华</td>
<td style="text-align:center">部门主管</td>
<td style="text-align:center">13345698432</td>
<td style="text-align:center">1876.00</td>
</tr>
</tbody>
</table>
<p>    (4)每个部门的员工中有一名是经理，每个经理只能管理一个部门，系统需要记录每个经理的任职时间。<br>
【概念模型设计】<br>
    根据需求阶段收集的信息，设计的实体联系图和关系模式（不完整）如下图</p>
<img src="./p117.png" width="300">
<p>【关系模式设计】<br>
商场（商场编号，商场名称，地址，联系电话）<br>
部门（部门编号，部门名称，位置分布，联系电话，(a)）<br>
员工（员工编号，员工姓名，岗位，电话号码，工资，(b)）<br>
经理（(c)，任职时间）</p>
<p>【问题1】<br>
    根据问题描述，补充四个联系，完善图中的实体联系图，联系名可以使用联系1、联系2、联系3和联系4代替，联系的类型分别为1:1、1:n、m:n。<br>
【问题2】<br>
    根据实体联系图，将关系模式中的空(a)-(c)补充完整，并分别给出部门、员工和经理的关系模式的主键和外键。<br>
【问题3】<br>
    为了使商场有紧急事务时能够联系到轮休的员工，要求每位员工必须且只能登记一位紧急联系人的姓名和电话，不同的员工可以登记相同的紧急联系人，则要在图中还需要添加的实体为(1)，该实体和途中员工存在什么联系（填写联系类型）。给出该实体的关系模式。</p>
<p><strong><code>下面是解答</code></strong></p>
<hr>
<p>解：<br>
【问题1】<br>
<img src="./p118.png" width="450"></p>
<p>【问题2】<br>
(a)：所属商场编号<br>
(b)：所属部门编号<br>
(c)：员工编号<br>
<br>
部门关系模式中：部门编号（主键），商场编号（外键）<br>
员工关系模式中：员工编号（主键），部门编号（外键）<br>
经理关系模式中：员工编号（主键和外键）</p>
<p>【问题3】<br>
紧急联系人关系模式（员工编号，员工姓名，电话）<br>
紧急联系人与员工一对多关系</p>

</body>
</html>
